<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>主管後台 - 輕井澤</title>
  <link rel="stylesheet" href="manager.css">
</head>
<body>
  <button id="logoutBtn" onclick="logout()" style="display:none;">登出</button>

  <!-- 分頁導覽 -->
  <div class="tabs" style="display:none;">
    <button class="tab-btn active" onclick="switchTab('leave')">📋 請假紀錄</button>
    <button class="tab-btn" onclick="switchTab('register')">➕ 建立帳號</button>
    <button class="tab-btn" onclick="switchTab('schedule')">📆 排班表</button>
    <button class="tab-btn" onclick="switchTab('account')">📖 所有帳號</button>
  </div>

  <!-- 📋 請假紀錄 -->
  <div class="tab-section" id="leaveTab">
    <h3>📋 請假紀錄</h3>
    <table id="leaveTable">
      <thead>
        <tr>
          <th>姓名</th><th>請假日期</th><th>假別</th><th>時段</th><th>原因</th><th>送出時間</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- ➕ 建立帳號 -->
  <div class="tab-section" id="registerTab" style="display:none;">
    <h3>➕ 建立帳號</h3>
    <input type="text" id="newRealName" placeholder="真實姓名">
    <input type="text" id="newUser" placeholder="帳號">
    <input type="password" id="newPass" placeholder="密碼">
    <select id="newRole">
      <option value="staff">員工</option>
      <option value="manager">主管</option>
    </select>
    <button onclick="registerUser()">建立帳號</button>
    <p id="registerMsg" class="message"></p>
  </div>

  <!-- 📆 排班表 -->
  <div class="tab-section" id="scheduleTab" style="display:none;">
    <h3>📆 排班表</h3>
    <p>這裡可以顯示或設定每日排班資訊（內場／外場）</p>
  </div>

  <!-- 📖 所有帳號 -->
  <div class="tab-section" id="accountTab" style="display:none;">
    <h3>📖 所有帳號</h3>
    <table id="accountTable">
      <thead>
        <tr>
          
          <th>帳號</th>
          <th>密碼</th>
          <th>角色</th>
          <th>真實姓名</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script src="manager.js"></script>
  <script>
    function loadAccounts() {
      fetch("https://script.google.com/macros/s/AKfycbwzx3Xw3AG5nlirhS89yVM9gb-6vMAI8KyI9BznZDaWKEvi71epGMvDD7YQDgu4I_bx/exec?action=read")
        .then(res => res.json())
        .then(data => {
          const tbody = document.querySelector("#accountTable tbody");
          tbody.innerHTML = "";
          data.forEach(row => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
              <td>${row.username || ""}</td>
              <td>${row.password || ""}</td>
              <td>${row.role || ""}</td>
              <td>${row.name || ""}</td>
            `;
            tbody.appendChild(tr);
          });
        })
        .catch(err => {
          alert("❌ 帳號資料讀取失敗");
          console.error(err);
        });
    }

    function switchTab(tab) {
      document.querySelectorAll(".tab-btn").forEach(btn => btn.classList.remove("active"));
      document.querySelectorAll(".tab-section").forEach(div => div.style.display = "none");
      document.querySelector(`.tab-btn[onclick="switchTab('${tab}')"]`).classList.add("active");
      const tabEl = document.getElementById(tab + "Tab");
      if (tabEl) tabEl.style.display = "block";
      if (tab === "account") loadAccounts();
    }
  </script>
</body>
</html>
