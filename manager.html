<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>ä¸»ç®¡å¾Œå° - è¼•äº•æ¾¤</title>
  <link rel="stylesheet" href="manager.css">
</head>
<body>
  <button id="logoutBtn" onclick="logout()" style="display:none;">ç™»å‡º</button>

  <!-- åˆ†é å°è¦½ -->
  <div class="tabs" style="display:none;">
    <button class="tab-btn active" onclick="switchTab('leave')">ğŸ“‹ è«‹å‡ç´€éŒ„</button>
    <button class="tab-btn" onclick="switchTab('register')">â• å»ºç«‹å¸³è™Ÿ</button>
    <button class="tab-btn" onclick="switchTab('schedule')">ğŸ“† æ’ç­è¡¨</button>
    <button class="tab-btn" onclick="switchTab('account')">ğŸ“– æ‰€æœ‰å¸³è™Ÿ</button>
  </div>

  <!-- ğŸ“‹ è«‹å‡ç´€éŒ„ -->
  <div class="tab-section" id="leaveTab">
    <h3>ğŸ“‹ è«‹å‡ç´€éŒ„</h3>
    <table id="leaveTable">
      <thead>
        <tr>
          <th>å§“å</th><th>è«‹å‡æ—¥æœŸ</th><th>å‡åˆ¥</th><th>æ™‚æ®µ</th><th>åŸå› </th><th>é€å‡ºæ™‚é–“</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- â• å»ºç«‹å¸³è™Ÿ -->
  <div class="tab-section" id="registerTab" style="display:none;">
    <h3>â• å»ºç«‹å¸³è™Ÿ</h3>
    <input type="text" id="newRealName" placeholder="çœŸå¯¦å§“å">
    <input type="text" id="newUser" placeholder="å¸³è™Ÿ">
    <input type="password" id="newPass" placeholder="å¯†ç¢¼">
    <select id="newRole">
      <option value="staff">å“¡å·¥</option>
      <option value="manager">ä¸»ç®¡</option>
    </select>
    <button onclick="registerUser()">å»ºç«‹å¸³è™Ÿ</button>
    <p id="registerMsg" class="message"></p>
  </div>

  <!-- ğŸ“† æ’ç­è¡¨ -->
  <div class="tab-section" id="scheduleTab" style="display:none;">
    <h3>ğŸ“† æ’ç­è¡¨</h3>
    <p>é€™è£¡å¯ä»¥é¡¯ç¤ºæˆ–è¨­å®šæ¯æ—¥æ’ç­è³‡è¨Šï¼ˆå…§å ´ï¼å¤–å ´ï¼‰</p>
  </div>

  <!-- ğŸ“– æ‰€æœ‰å¸³è™Ÿ -->
  <div class="tab-section" id="accountTab" style="display:none;">
    <h3>ğŸ“– æ‰€æœ‰å¸³è™Ÿ</h3>
    <table id="accountTable">
      <thead>
        <tr>
          
          <th>å¸³è™Ÿ</th>
          <th>å¯†ç¢¼</th>
          <th>è§’è‰²</th>
          <th>çœŸå¯¦å§“å</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script src="manager.js"></script>
  <script>
    function loadAccounts() {
      fetch("https://script.google.com/macros/s/AKfycbwzx3Xw3AG5nlirhS89yVM9gb-6vMAI8KyI9BznZDaWKEvi71epGMvDD7YQDgu4I_bx/exec?action=read")
        .then(res => res.json())
        .then(data => {
          const tbody = document.querySelector("#accountTable tbody");
          tbody.innerHTML = "";
          data.forEach(row => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
              <td>${row.username || ""}</td>
              <td>${row.password || ""}</td>
              <td>${row.role || ""}</td>
              <td>${row.name || ""}</td>
            `;
            tbody.appendChild(tr);
          });
        })
        .catch(err => {
          alert("âŒ å¸³è™Ÿè³‡æ–™è®€å–å¤±æ•—");
          console.error(err);
        });
    }

    function switchTab(tab) {
      document.querySelectorAll(".tab-btn").forEach(btn => btn.classList.remove("active"));
      document.querySelectorAll(".tab-section").forEach(div => div.style.display = "none");
      document.querySelector(`.tab-btn[onclick="switchTab('${tab}')"]`).classList.add("active");
      const tabEl = document.getElementById(tab + "Tab");
      if (tabEl) tabEl.style.display = "block";
      if (tab === "account") loadAccounts();
    }
  </script>
</body>
</html>
